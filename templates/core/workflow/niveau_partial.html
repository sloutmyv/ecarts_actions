<!-- Template partiel optimisÃ© pour un niveau de validation -->
<div class="flex items-center gap-2">
    <!-- Indicateur de niveau -->
    <div class="w-5 h-5 {% if niveau == 1 %}bg-green-500{% elif niveau == 2 %}bg-blue-500{% else %}bg-purple-500{% endif %} rounded-full flex items-center justify-center">
        <span class="text-white text-xs font-semibold leading-none">{{ niveau }}</span>
    </div>
    
    {% if validateur_assigne %}
        <!-- Validateur assignÃ© -->
        <div class="flex items-center gap-1.5 {% if niveau == 1 %}bg-green-100 text-green-800 border-green-200{% elif niveau == 2 %}bg-blue-100 text-blue-800 border-blue-200{% else %}bg-purple-100 text-purple-800 border-purple-200{% endif %} px-2.5 py-1 rounded border">
            <span class="font-medium text-xs">{{ validateur_assigne.validateur.get_full_name }}</span>
            <button hx-get="{% url 'remove_validator' validateur_assigne.pk %}"
                   hx-target="#modal-container"
                   hx-swap="innerHTML"
                   class="{% if niveau == 1 %}text-green-600 hover:text-red-600{% elif niveau == 2 %}text-blue-600 hover:text-red-600{% else %}text-purple-600 hover:text-red-600{% endif %} transition-colors" 
                   title="Retirer ce validateur">
                <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                </svg>
            </button>
        </div>
    {% else %}
        <!-- Bouton d'assignation -->
        <button onclick="window.openAssignModal({{ service.id }}, '{{ service.nom|escapejs }}', {{ audit_source.id }}, '{{ audit_source.name|escapejs }}', {{ niveau }})"
                class="flex items-center gap-1 {% if niveau == 1 %}text-green-600 hover:text-green-800 border-green-300 hover:bg-green-50{% elif niveau == 2 %}text-blue-600 hover:text-blue-800 border-blue-300 hover:bg-blue-50{% else %}text-purple-600 hover:text-purple-800 border-purple-300 hover:bg-purple-50{% endif %} px-2.5 py-1 border border-dashed rounded font-medium text-xs transition-all hover:border-solid">
            <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"/>
            </svg>
            Assigner
        </button>
    {% endif %}
</div>